var App=Ember.Application.create();App.ApplicationAdapter=DS.RESTAdapter.extend({host:"http://ember-menu.appspot.com"});App.Router.map(function(){this.route("intro");this.route("menulist",{path:"/menulist/:menulist_id"});this.route("menuitem",{path:"/menuitem/:menuitem_id"});this.route("order")});App.PageView=Ember.View.extend({classNameBindings:["templateName"],didInsertElement:function(){$.mobile.changePage(this.$())}});
$(document).bind("pageinit",function(){$(".main-menu ul").listview();$(".main-menu-button").on("click",function(a){a.preventDefault();$(".main-menu").panel("open")})});$(document).bind("mobileinit",function(){$.mobile.ajaxEnabled=!1;$.mobile.linkBindingEnabled=!1;$.mobile.hashListeningEnabled=!1;$.mobile.pushStateEnabled=!1;$.mobile.defaultPageTransition="none"});App.OrderController=Ember.ObjectController.extend({total:function(){var a=0;this.get("menuitems").forEach(function(b){a+=b.get("price")});return a.toFixed(2)}.property("menuitems.@each")});App.Menuitem=DS.Model.extend({name:DS.attr("string"),imageURL:DS.attr("string"),description:DS.attr("string"),menulist:DS.belongsTo("menulist"),price:DS.attr("number")});App.Menulist=DS.Model.extend({menuitems:DS.hasMany("menuitem")});App.Order=DS.Model.extend({menuitems:DS.hasMany("menuitem"),table:DS.attr("string")});App.IndexRoute=Ember.Route.extend({redirect:function(){this.transitionTo("intro")}});App.MenuitemRoute=Ember.Route.extend({actions:{back:function(a){this.transitionTo("menulist",a.id)},add:function(a){var b=this.store;b.find("menuitem",a).then(function(a){b.find("order","dummy").then(function(b){b.get("menuitems").pushObject(a);$(".dish-added-popup").popup();$(".dish-added-popup").popup("open")})})}}});App.MenulistRoute=Ember.Route.extend({actions:{detail:function(a){this.transitionTo("menuitem",a)}}});App.OrderRoute=Ember.Route.extend({model:function(){return this.store.find("order","dummy")},actions:{"delete":function(a){var b=this.store;b.find("menuitem",a).then(function(a){b.find("order","dummy").then(function(b){b=b.get("menuitems");for(var c=b.get("length")||0;0<=--c;){var d=b.objectAt(c);console.log(d,a);if(d===a){b.removeAt(c);break}}})})},submit:function(a){this.store.find("order","dummy").then(function(a){a.get("table")?(a.save(),$(".dish-confirm-popup").popup(),$(".dish-confirm-popup").popup("open")):
($(".dish-empty-popup").popup(),$(".dish-empty-popup").popup("open"))})}}});App.IntroView=App.PageView.extend({templateName:"intro"});App.MenuitemView=App.PageView.extend({templateName:"menuitem"});App.MenulistView=App.PageView.extend({templateName:"menulist"});App.OrderView=App.PageView.extend({templateName:"order"});